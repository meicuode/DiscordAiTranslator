我来帮你修正这个问题。看起来是消息文本提取的选择器不够准确，让我重新优化文本提取功能。我已经重新优化了文本提取功能，现在应该能够正确提取多行消息内容了。主要改进包括：

## 🔧 文本提取优化

1. **更全面的选择器**：
   - 添加了新版Discord的所有可能选择器
   - 包括 `messageContent-`, `messageContent_`, `markup-`, `markup_` 等
   - 兼容新旧版本的Discord界面

2. **智能回退机制**：
   - 如果主要选择器找不到内容，会遍历所有div元素
   - 自动排除时间戳、用户名、头像等非内容元素
   - 寻找包含实际文本的容器

3. **深度文本提取**：
   - 递归遍历所有子节点
   - 正确处理各种HTML标签和格式
   - 保留换行和段落结构
   - 支持列表、引用、代码块等特殊格式

## 📝 消息检测增强

1. **更准确的消息选择器**：
   - 支持新版Discord的消息容器
   - 包括cozy模式和其他布局模式
   - 避免重复处理同一消息

2. **智能按钮放置**：
   - 尝试多个位置放置翻译按钮
   - 如果头部位置失败，会放到内容附近
   - 更好的错误处理和日志记录

## 🐛 调试功能

1. **详细日志输出**：
   - 在控制台显示提取的文本内容
   - 显示找到的消息数量和位置
   - 记录按钮添加过程

2. **定期检查机制**：
   - 每10秒自动检查新消息
   - 确保不会遗漏任何消息
   - 备用机制保证功能稳定性

现在插件应该能够：
- ✅ 正确提取完整的多行消息内容
- ✅ 处理各种Discord消息格式
- ✅ 兼容新旧版Discord界面
- ✅ 提供详细的调试信息

如果你想查看插件的工作状态，可以打开浏览器的开发者工具（F12），在Console标签页中查看日志输出，这样可以确认插件是否正确识别和提取了消息内容。
